install.packages("ggplot2")
library(ggplot2)
getwd()
setwe("C:/Users/jason/Desktop/CS526/CS526_Project1")
setwd("C:/Users/jason/Desktop/CS526/CS526_Project1")
getwd()
data <- read.csv("Project1_cs526 - Project1.csv")
data
View(data)
View(data)
head(data)
str(data)
data$LogError <- log2(abs(data$UserAnswer - data$TruthPercentage) + 1/8)
head(data)
stats <- data.frame(
PlotName = tapply(data$LogError, data$PlotName, function(x) unique(data$PlotName[data$LogError %in% x])[1]),
Mean_LogError = tapply(data$LogError, data$PlotName, mean),
SD = tapply(data$LogError, data$PlotName, sd),
N = tapply(data$LogError, data$PlotName, length)
)
stats
View(stats)
View(stats)
# =====================
data <- read.csv("Project1_cs526 - Project1.csv")
# compute mean error for each technique
# mean_errors <- aggregate(Error ~ Technique, data = data, FUN = mean)
# names(mean_errors)[2] <- "Mean_Error"
data$LogError <- log2(abs(data$UserAnswer - data$TruthPercentage) + 1/8)
View(data)
View(data)
stats <- aggregate(LogError ~ PlotName, data = data,
FUN = function(x) c(mean = mean(x),
sd = sd(x),
n = length(x)))
stats <- data.frame(
PlotName = stats$PlotName,
Mean_LogError = stats$LogError[, "mean"],
SD = stats$LogError[, "sd"],
N = stats$LogError[, "n"]
)
stats
stats$SE <- stats$SD / sqrt(stats$N)
# Calculate 95% confidence interval
stats$CI_Lower <- stats$Mean_Error - 1.96 * stats$SE
stats$SE <- stats$SD / sqrt(stats$N)
# Calculate 95% confidence interval
stats$CI_Lower <- stats$Mean_LogError - 1.96 * stats$SE
stats$CI_Upper <- stats$Mean_LogError + 1.96 * stats$SE
print("Summary Statistics:")
print(stats)
# Create a bar plot with error bars showing 95% CI
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 3,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
ylim(0, max(stats$CI_Upper) + 5)
barChart
data <- read.csv("Project1_cs526 - Project1.csv")
# compute mean error for each technique
# mean_errors <- aggregate(Error ~ Technique, data = data, FUN = mean)
# names(mean_errors)[2] <- "Mean_Error"
data$LogError <- log2(abs(data$UserAnswer - data$TruthPercentage) + 1/8)
# compute standard error (SE) for 95% confidence interval
# SE = sd / sqrt(n)
# 95% CI = mean Â± 1.96 * SE
# stats <- aggregate(LogError ~ PlotName, data = data,
#                    FUN = function(x) c(mean = mean(x),
#                                        sd = sd(x),
#                                        n = length(x)))
#
# stats <- data.frame(
#   PlotName = stats$PlotName,
#   Mean_LogError = stats$LogError[, "mean"],
#   SD = stats$LogError[, "sd"],
#   N = stats$LogError[, "n"]
# )
stats <- data.frame(
PlotName = tapply(data$LogError, data$PlotName, function(x) unique(data$PlotName[data$LogError %in% x])[1]),
Mean_LogError = tapply(data$LogError, data$PlotName, mean),
SD = tapply(data$LogError, data$PlotName, sd),
N = tapply(data$LogError, data$PlotName, length)
)
stats <- aggregate(LogError ~ PlotName, data = data,
FUN = function(x) c(mean = mean(x),
sd = sd(x),
n = length(x)))
stats <- data.frame(
PlotName = stats$PlotName,
Mean_LogError = stats$LogError[, "mean"],
SD = stats$LogError[, "sd"],
N = stats$LogError[, "n"]
)
# create a dot/bar plot with error bars showing 95% CI
dotPlot <- ggplot(stats, aes(y = PlotName, x = Mean_LogError, fill = PlotName)) +
geom_point(size = 2) +
geom_errorbar(aes(xmin = CI_Lower, xmax = CI_Upper),
width = 0.2,
size = 0.5) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
y = "Visualization",
x = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
xlim(0, max(stats$CI_Upper) + 5)
# display the plot
print(barChart)
print(dotPlot)
stats$SE <- stats$SD / sqrt(stats$N)
# Calculate 95% confidence interval
stats$CI_Lower <- stats$Mean_LogError - 1.96 * stats$SE
stats$CI_Upper <- stats$Mean_LogError + 1.96 * stats$SE
print("Summary Statistics:")
print(stats)
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 3,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
ylim(0, max(stats$CI_Upper) + 5)
# create a dot/bar plot with error bars showing 95% CI
dotPlot <- ggplot(stats, aes(y = PlotName, x = Mean_LogError, fill = PlotName)) +
geom_point(size = 2) +
geom_errorbar(aes(xmin = CI_Lower, xmax = CI_Upper),
width = 0.2,
size = 0.5) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
y = "Visualization",
x = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
xlim(0, max(stats$CI_Upper) + 5)
# display the plot
print(barChart)
print(dotPlot)
print(barChart)
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 3,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
ylim(0, max(stats$CI_Upper) + 2)
print(barChart)
# Create a bar plot with error bars showing 95% CI
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 3,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
# ylim(0, max(stats$CI_Upper) + 2)
coord_cartesian(ylim = c(0, max(stats$CI_Upper) * 1.1))
print(barChart)
# Create a bar plot with error bars showing 95% CI
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
#nudge_y = 3,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
# ylim(0, max(stats$CI_Upper) + 2)
coord_cartesian(ylim = c(0, max(stats$CI_Upper) * 1.1))
print(barChart)
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 1,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
# ylim(0, max(stats$CI_Upper) + 2)
coord_cartesian(ylim = c(0, max(stats$CI_Upper) * 1.1))
print(barChart)
# Create a bar plot with error bars showing 95% CI
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 0.75,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c("A" = "#2E86AB",
"B" = "#A23B72",
"C" = "#F18F01")) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
# ylim(0, max(stats$CI_Upper) + 2)
coord_cartesian(ylim = c(0, max(stats$CI_Upper) * 1.1))
print(barChart)
barChart <- ggplot(stats, aes(x = PlotName, y = Mean_LogError, fill = PlotName)) +
geom_bar(stat = "identity", width = 0.6, alpha = 0.7) +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper),
width = 0.2,
size = 1) +
geom_text(aes(label = round(Mean_LogError, 1)),
vjust = -0.5,
hjust = 0.5,
nudge_y = 0.75,
size = 4) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
x = "Visualization",
y = "Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c(
"bar" = "#2E86AB",
"dividedBar" = "#A23B72",
"pie" = "#F18F01",
"radialBar" = "#6A994E",
"heat" = "#BC4749",
"alpha" = "#8E9AAF",
"radial" = "#577590",
"dividedBarBot" = "#FFAFCC"
))+
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
# ylim(0, max(stats$CI_Upper) + 2)
coord_cartesian(ylim = c(0, max(stats$CI_Upper) * 1.1))
print(barChart)
dotPlot <- ggplot(stats, aes(y = PlotName, x = Mean_LogError, fill = PlotName)) +
geom_point(size = 2) +
geom_errorbar(aes(xmin = CI_Lower, xmax = CI_Upper),
width = 0.2,
size = 0.5) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
y = "Visualization",
x = "Log Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c(
"bar" = "#2E86AB",
"dividedBar" = "#A23B72",
"pie" = "#F18F01",
"radialBar" = "#6A994E",
"heat" = "#BC4749",
"alpha" = "#8E9AAF",
"radial" = "#577590",
"dividedBarBot" = "#FFAFCC"
))+
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
xlim(0, max(stats$CI_Upper) + 5)
print(dotPlot)
print(barChart)
ggsave("visualization_comparison.png", plot, width = 8, height = 6, dpi = 300)
ggsave("visualization_comparison.png", barChart, width = 8, height = 6, dpi = 300)
ggsave("visualization_comparison.png", dotPlot, width = 8, height = 6, dpi = 300)
ggsave("visualization_comparison_1.png", barChart, width = 8, height = 6, dpi = 300)
ggsave("visualization_comparison_2.png", dotPlot, width = 8, height = 6, dpi = 300)
dotPlot <- ggplot(stats, aes(y = PlotName, x = Mean_LogError, fill = PlotName)) +
geom_point(size = 2) +
geom_errorbar(aes(xmin = CI_Lower, xmax = CI_Upper),
width = 0.2,
size = 0.5) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
y = "Visualization",
x = "Log Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c(
"bar" = "#2E86AB",
"dividedBar" = "#A23B72",
"pie" = "#F18F01",
"radialBar" = "#6A994E",
"heat" = "#BC4749",
"alpha" = "#8E9AAF",
"radial" = "#577590",
"dividedBarBot" = "#FFAFCC"
))+
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
xlim(0, max(stats$CI_Upper) + 2)
print(dotPlot)
dotPlot <- ggplot(stats, aes(y = PlotName, x = Mean_LogError, fill = PlotName)) +
geom_point(size = 2) +
geom_errorbar(aes(xmin = CI_Lower, xmax = CI_Upper),
width = 0.2,
size = 0.5) +
labs(
title = "Estimation Log error",
subtitle = "Error bars represent 95% confidence intervals",
y = "Visualization",
x = "Log Error (%)",
fill = "PlotName"
) +
scale_fill_manual(values = c(
"bar" = "#2E86AB",
"dividedBar" = "#A23B72",
"pie" = "#F18F01",
"radialBar" = "#6A994E",
"heat" = "#BC4749",
"alpha" = "#8E9AAF",
"radial" = "#577590",
"dividedBarBot" = "#FFAFCC"
))+
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
legend.position = "none"
) +
xlim(0, max(stats$CI_Upper) + 1)
print(dotPlot)
ggsave("visualization_comparison_1.png", barChart, width = 8, height = 6, dpi = 300)
ggsave("visualization_comparison_2.png", dotPlot, width = 8, height = 6, dpi = 300)
write.csv(stats, file = "vis_stats.csv")
